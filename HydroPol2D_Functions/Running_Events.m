%% Running Events

% ----- Running Testing Events ---- %
% Developer: Marcus Nobrega
% How to use:
% Enter the events below. Following this, change the HydroPol2D inputs by
% loading the workspace in Objective_Function_Plots. Following this, you
% choose the calibrated C3 e C4, the slope value s0 and the observed
% concentration with the respective time. Below we organize inputs with S0
% and S2, that is, 0.5 deg and 2 deg of slope.

%% S0 Events

% Optimized Parameters
% C3_calibrated = 9036.83813876743;
% C4_calibrated = 0.243545935909623;

% S0.5-1
% i = 24.22; % mm/h
% time_observed_concentration = [0.956989247	1.204301075	1.47311828	1.720430108	1.967741935	2.204301075	2.462365591	2.720430108	2.967741935	3.47311828	3.978494624	4.47311828	4.978494624	5.483870968	5.989247312	6.494623656	7	7.483870968	8.010752688	8.516129032	9	9.505376344	9.989247312]; % min
% observed_concentration = 1000*[28.60759494	27.46835443	25.82278481	24.30379747	21.51898734	17.84810127	15.44303797	13.03797468	11.7721519	11.26582278	10.75949367	10.25316456	9.240506329	7.848101266	6.708860759	5.443037975	4.303797468	3.670886076	2.658227848	1.898734177	1.64556962	1.139240506	1.139240506]'; % mg/L
% s0 = 0.5; % Degrees

% S0.5-2
% i = 43.16; % mm/h
% time_observed_concentration = [0.56194765	0.807824374	1.059848016	1.311871658	1.5638953	1.815918942	2.061795666	2.319966226	2.56584295	3.063743316	3.561643681	4.053397129	4.127160146	4.551297495	5.049197861	5.553245145	6.062209963	6.573633549	7.077680833	7.575581199	8.073481565	8.577528849	9.069282297	9.573329581]; % min
% observed_concentration = 1000*[30.8330622	25.55811005	22.04568421	17.88056818	14.11431579	11.98648325	10.24921053	9.778971292	9.060550239	8.162636404	6.722416268	5.07937799	4.861052632	3.591842105	2.424563397	1.87811244	1.429873684	1.245	1.145789474	1.161184211	1.032894737	0.930263158	0.889210526	0.807105263]'; % mg/L
% s0 = 0.5; % Degrees

% S0.5-3
% i = 63.81; % mm/h
% time_observed_concentration = [0.525066141	0.789856459	1.041407261	1.294849423	1.533160709	1.866039966	2.116093442	2.389946524	2.559696032	3.020714889	3.524762173	4.028809457	4.532856741	5.036904025	5.540951309	6.032704757	6.530605122	7.02235857	7.514112018	8.012012384	8.516059668	9.013960034	9.518007318]; % min
% observed_concentration = 1000*[23.21394737	18.38947368	16.17291866	11.46203509	9.653947368	8.028736842	7.220723684	5.534736842	4.40377193	2.885592105	1.854413876	1.087433667	0.701938995	0.462263158	0.19458134	0.329678363	0.230828947	1.023486842	1.089342105	0.995947368	0.895368421	0.861842105	0.778026316]'; % mg/L
% s0 = 0.5; % Degrees

% S0 5.4
% i = 76.34; % mm/h
% observed_concentration = 1000*[26.22210526	20.04921053	14.94608772	12.29970395	8.823421053	8.303947368	8.115592105	6.836157895	5.873	3.917184211	2.280125	1.216698565	0.708578947	0.791197368	0.335	0.263157895	0.837894737	0.786578947	1.412631579	1.268947368	0.751684211	0.708578947	0.660684211	0.615184211]'; % mg/L
% time_observed_concentration = [0.482037715	0.684886012	0.946130031	1.195080214	1.454669294	1.720405291	1.978575851	2.244311849	2.461345342	2.940804954	3.444852238	3.930458767	4.428359133	4.932406417	5.437683085	5.946647903	6.456842105	6.925764143	7.526405854	8.030453138	8.443935829	8.934869688	9.44055615	9.923703912]; % min
% s0 = 0.5; % Degrees


%% S2 Events

% Optimized Parameters

C3_calibrated = 7445.11466967324 ;
C4_calibrated = 0.191619318878533;

% S2-1
% i = 20.76; % mm/h
% observed_concentration = 1000*[41.01694915	33.77118644	28.1779661	23.72881356	19.78813559	16.10169492	13.05084746	10.12711864	7.584745763	5.296610169	3.898305085	3.13559322	2.372881356	1.991525424	1.86440678	1.355932203	1.101694915	0.847457627	0.847457627	0.720338983]'; % mg/L
% time_observed_concentration = [1.183673469	1.518607443	1.853541417	2.18847539	2.523409364	2.847539016	3.182472989	3.679471789	4.165666267	4.673469388	5.159663866	5.68907563	6.18607443	6.693877551	7.190876351	7.677070828	8.195678271	8.681872749	9.178871549	9.697478992]; % min
% s0 = 2; % Degrees

% S2-2
% i = 41.72; % mm/h
% observed_concentration = 1000*[29.11783344	25.60204876	21.02322989	17.05825728	13.06101164	9.938162721	6.819875447	4.330826935	2.903568522	1.744373872	1.095180959	1.010562259	0.913081042	1.048857082	0.874977885	0.75905842	0.672923817	0.447524858	0.954672517	0.858072963	0.773548353]'; % mg/L
% time_observed_concentration = [0.668832878	1.007511146	1.340031629	1.678709897	2.005072593	2.343750862	2.676271344	3.175052067	3.667675003	4.172613513	4.671394236	5.176332746	5.681271256	6.180051979	6.672674915	7.177613425	7.676394148	8.162859298	8.673955595	9.178894105	9.677674828]; % min
% s0 = 2; % Degrees

% S2-3
% i = 62.61; % mm/h
% observed_concentration = 1000*[32.1607194	22.63523495	14.90959272	10.48784102	6.994340096	4.504706132	3.120400021	1.553589753	1.35918315	1.268621068	1.002972294	0.721223594	0.592424189	0.686608754	0.845998018	0.751813453	0.708343654	0.447524858	0.471674746	0.882222851	0.761473409]'; % mg/L
% time_observed_concentration = [0.489697264	0.822777545	1.161455814	1.487818509	1.826496778	2.171332834	2.497695529	3.008791826	3.507572549	4.000195485	4.505133995	5.010072505	5.508853228	6.003939279	6.500256888	7.011353184	7.503976121	8.008914631	8.507695354	8.994160503	9.499099013]; % min
% s0 = 2; % Degrees

% S2-4
% i = 83.99; % mm/h
% observed_concentration = 1000*[27.91802307	19.92199498	13.39387761	9.005741127	5.439306819	3.484373341	2.357561497	1.244471179	1.244471179	0.954672517	0.749398464	0.606914122	0.664873854	0.519974523	0.519974523	0.375075192	0.519974523]'; % mg/L
% time_observed_concentration = [0.404048049	0.736568531	1.05677344	1.395451709	1.721814404	2.06665046	2.393013155	2.916425025	3.427521322	4.462029488	4.936179065	5.434959788	6.962090891	7.44855604	7.941178977	8.446117487	9.936301869]; % min
% s0 = 2; % Degrees


%% Watershed - Wooden Board
pixel_size = 0.15; % m
L = 3; % Length (m)
W = 1.5; % Width (m)

h0 = 0; % mm
d0 = 0.2; % mm

% Decision Vector
x = [C3_calibrated, C4_calibrated, i,pixel_size,s0,W,L,h0,d0]'; % It will be entered in HydroPol2D model

% Model
[Obj_function_value,NSE,r2,PBIAS,output_data] = Objective_Function_Plots(x,observed_concentration,time_observed_concentration)

data = zeros(size(output_data,1),size(output_data,2) + 4); % Final Output
data(1,1:4) = [Obj_function_value,NSE,r2(2,1),PBIAS];
data(:,5:end) = output_data;

